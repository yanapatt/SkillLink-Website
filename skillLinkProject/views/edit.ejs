<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Edit Post</title>
    <link rel="stylesheet" href="/styles/style.css" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
</head>

<body>
    <div class="navbar-container">
        <div class="navbar-left">
            <a href="/" style="font-size: 20px">Skillink</a>
            <a href="#">Welcome <%= accUsername %>, Your Role is: <%= accRole %></a>
        </div>
        <a href="/logout">
            <button class="primary-outline-btn">Logout</button></a>
    </div>

    <div class="center-content">
        <h2>แก้ไขโพสต์</h2>

        <% if (post && post.length> 0) { %>
            <% post.forEach(p=> { %>
                <form action="/update/<%= p.postTitle %>" method="POST" enctype="multipart/form-data"
                    id="edit-post-form">
                    <label>Name:</label>
                    <input type="text" name="postTitle" value="<%= p.postTitle %>" readonly>

                    <label>Description:</label>
                    <textarea name="postDesc" required><%= p.postDesc %></textarea>

                    <input type="hidden" name="deleteImg" id="deleteImg" value="false" />

                    <label>Current Image:</label>
                    <% if (p.postImgUrl) { %>
                        <div id="image-container">
                            <img src="<%= p.postImgUrl %>" alt="Post Image" width="150" id="post-image">
                            <button class="primary-btn" type="button" id="delete-image-btn" onclick="handleDeleteImage()">Delete
                                Image</button>
                        </div>
                        <% } else { %>
                            <input type="file" name="postImgUrl" accept="image/*" id="image-upload">
                            <% } %>

                                <br><br>
                                <button class="secondary-btn" type="submit">Update Post</button>
                </form>
                <br><a href="/">Back to Post List</a>
                <hr />
                <% }) %>
                    <% } else { %>
                        <h1>Post Not Found</h1>
                        <a href="/">Back to Post List</a>
                        <% } %>
    </div>
</body>

</html>

<script src="/js/main.js"></script>